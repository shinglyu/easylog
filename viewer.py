import argparse
import fileinput
import json
from colorama import Fore, Back, Style, init
import sys
init(autoreset=True) # colorama

def main():
    parser = argparse.ArgumentParser(description='Print easylog JSON file')
    parser.add_argument('filename', type=argparse.FileType("r"),
                        help='the log json generated by easylog')

    args = parser.parse_args()

    json_str = args.filename.read()
    args.filename.close()

    lines = json.loads(json_str)
    for line in lines:
        if 'important' in line['tags']:
            # print(colored(line['line'], 'red'))
            sys.stdout.write(Back.RED + Fore.WHITE + line['line']),
            continue
        if 'error' in line['tags']:
            # print(colored(line['line'], 'red'))
            print(Fore.RED + line['line']),
            continue
        if 'warn' in line['tags']:
            # print(colored(line['line'], 'red'))
            print(Fore.YELLOW+ line['line']),
            continue
        else:
            print(Style.DIM + line['line']),



if __name__ == '__main__':
    main()
